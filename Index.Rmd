---
title: "Computational Musicology"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: rows
date: '2022-03-06'
---

```{r setup, include=FALSE}
library(flexdashboard)
library(ggplot2)
library(tidyverse)
library(spotifyr)
library(compmus)
```

Chromagram & Timbre
=====================================

Comments{data-height=200}
-------------------------------------

### Comments

The norm of both visualizations were filled in with the euclidian norm. the method of the cepstrogram is root mean square. It is interesting to see that the timbre of ABC by The Jackson 5 doesn't change except at t = 45 to t = 50. While listening to the song, there doesn't seem to be anything different during this time relative to the rest of the song.

While A lot of the song's energy is in G-sharp, ABC is a song with a lot of different tunes and melodies playing at the same time. This is also very noticeable in the chromagram of ABC.

Timbre{data-height = 800}
-------------------------------------
### Timbre

```{r }
abc <-
  get_tidy_audio_analysis("6D8kc7RO0rqBLSo2YPflJ5") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

abc %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = 'Cepstrogram of ABC by The Jackson 5', x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic()
```

### Chroma

```{r}
abc_chroma <-
  get_tidy_audio_analysis("6D8kc7RO0rqBLSo2YPflJ5") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

abc_chroma %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(title = 'Chromagram of ABC by The Jackson 5', x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

Introduction
=====================================

### Motown

Motown was a widely cherished label that has produced a lot of hits in the sixties and seventies. Even in the eighties Motown released a few hits like "Hello" by Lionel Richie or "I just called to say I love you" by Stevie Wonder. After Motown appointed new CEO Jheryl Busby in 1989, the label wasn't able to produce many more hits. The four hits from motown in the nineties were by Boys II Men. In the nineties, Motown would be sold and resold to many different labels, such as Polydor. Motown still had a rough time producing hits, but Motown kept releasing albums. A good example of a failed album released by motown is "Dirty South" by Rasheeda. Even though the single Do it made it far, the debut album by Rasheeda was recieved poorly and she was let go by Motown. During this project the difference between the hits Motown released in the 1900's and the albums that Motown released in the 2000's will be examined. To make a meaningfull comparison, a corpus has been created which contains the hits that Motown released and a couple of the albums Motown released in the 2000's, such as "Dirty South" by Rasheeda and "The people vs." by Tick Tick. The corpus consists of 128 songs. The most probable difference between Motown's 1900's and 2000's is the difference in genre. While Motown released a lot of 'westernized' soul and jazz tracks in the sixties through eighties, Motown switched to a more R&B approach by contracting boys to men in the nineties. These genres and their corresponding artists will therefore be examined during this project.

Visuals
=====================================

Comments{data-height=200}
--------------------------------------

### Comments about plot

It is clearly visible that, next to the last album that Stevie Wonder released, Motown lost their popularity around the 2000s. It is also visible from the plot that the speechiness increases during the time that the popularity decreases.

Visual{data-height=800}
--------------------------------------
### Visual
```{r motown}
motown <- get_playlist_audio_features("", "6lvlmqRVqND4iLCwqBOiev")
motown <- motown[order(motown$track.album.release_date),]
#endless love and papa was a rolling stone didn't have the original release so the release year has to be adjusted
motown[70, "track.album.release_date"] <- '1972'
motown[128,"track.album.release_date"] <- '1981'

#set the release date as a year so that grouping is easier
motown$track.album.release_date <- as.POSIXct(motown$track.album.release_date, format = "%Y")
motown$track.album.release_date <- format(motown$track.album.release_date, format="%Y")

#transform year from chars to numeric
motown <- transform(motown, track.album.release_date = as.numeric(track.album.release_date))

ggplot(motown, aes(x = track.album.release_date, y = speechiness, color = energy, size = track.popularity)) + geom_point()
```


Discussion
=====================================

### Discussion and conclusion

Seeing that speechiness and instrumenalness has increased in the 2000s, the same time that Motown found it difficult to release new hits may be what has put Motown in a different position. Lots of more speechiness shows that a big change in genre was introduced. Motown went from a soul, jazz and blues label to a R&B label. While pop songs had been what made the top 10s in a lot of countries in the 2000s. This may be part of the downfall of Motown.

